# 浮动

## 认识浮动

`float` 属性用于将元素脱离标准文档流，使其向左或右移动，允许文本或其他内联元素环绕其周围。其设计初衷是实现 **图文混排**（如杂志式排版中的图片与文字环绕），而非复杂布局。

- **历史背景**：在 CSS 早期（Flexbox 和 Grid 未普及前），`float` 被广泛用于多列布局（如两栏布局），尽管这超出了其原始设计范围。
- **与绝对定位的区别**：  
  - 浮动元素仍影响文档流的垂直高度计算（父元素高度可能因内容撑开），而 `position: absolute` 完全脱离文档流。
  - 浮动元素会与周围内容交互（如文本环绕），而绝对定位元素则独立于其他元素。

> **提示**：浮动与绝对定位都脱离标准流，但浮动更适合内容环绕场景。

**常用取值**：

- `none`：不浮动（默认值）。
- `left`：向左浮动。
- `right`：向右浮动。

## 浮动规则

### 规则一：脱离标准流

 元素一旦浮动后，将脱离标准流。 

- 它会朝着左或右方向移动，直到其边界紧贴包含块（通常是父元素）或其他浮动元素的边界。
- **层叠顺序**：
  - 浮动元素的层叠顺序（`z-index`）低于定位元素（`position: absolute/relative`）。
  - 浮动元素之间按声明顺序层叠，后声明的浮动元素会覆盖前一个（若空间不足则向下排列）。

![image-20231224173533028](./assets/image-20231224173533028.png)

### 规则二：边界限制

- 浮动元素的边界受 **包含块** （父容器）约束：
  - 左浮动元素左边界不能超出父容器左边界。
  - 右浮动元素右边界不能超出父容器右边界。
- **细节**：
  - 设置负外边距（如 `margin-left: -20px`）可让元素向外偏移，但超出包含块的部分会被截断，而非覆盖外部内容。

![image-20231224173607992](./assets/image-20231224173607992.png)

### 规则三：浮动元素的排列

- 浮动元素按顺序排列，不重叠：
  - 左浮动元素紧贴前一个左浮动元素，右浮动元素紧贴前一个右浮动元素。
  - 若水平空间不足，后续浮动元素会自动换行，寻找足够的空间。

![image-20231224173647618](./assets/image-20231224173647618.png)

### 规则四：与行内元素的交互

浮动元素会影响周围内容：

- **行内内容**（如文本、`inline-block` 元素）被推出并环绕浮动元素，不与其重叠。
- **块级元素**（如 `<div>`）保持标准流位置，但其内部文本会被浮动元素推开。
- **示例**：左浮动的图片会使右侧文字环绕，形成经典的图文混排效果。

![image-20231224173758109](./assets/image-20231224173758109.png)

### 规则五：浮动后的对齐方式

浮动元素顶部与**当前行的顶部**对齐：

- 行内元素浮动后转为块级特性，顶部与所在行对齐。
- 块级元素浮动后，顶部默认贴近父容器顶部（除非受其他浮动元素影响）。

![image-20231224173900259](./assets/image-20231224173900259.png)

## 浮动问题：高度塌陷（Height Collapse）

- **原因** ：浮动元素脱离标准流后，父容器无法感知其高度，导致高度塌陷（父容器高度变为 `0` 或仅包含非浮动内容的高度）。

- **示例**：

```html
<div class="parent">
  <img src="..." style="float: left;">
  <p>文本内容</p>
</div>
```

- 若父容器未清除浮动，其高度将仅包裹文本，图片可能溢出。

- 解决父元素高度坍塌问题的过程, 一般叫做清浮动(清理浮动、清除浮动)
- 清浮动的目的是
  - 让父元素计算总高度的时候, 把浮动子元素的高度算进去

## clear 属性

 `clear` 属性用于指定一个元素是否必须移动（清除浮动后）到在它之前的浮动元素下面。

`clear` 的常用取值： 

- `left`：元素顶部低于所有左浮动元素的底部。
- `right`：元素顶部低于所有右浮动元素的底部。
- `both`：元素顶部低于所有浮动元素的底部（最常用）。
- `none`：默认值，无清除行为。

## 清楚浮动的方法

### 1. 父容器设置 `overflow: hidden`

```css
.parent {
  overflow: hidden; /* 隐式清除浮动 */
}
```

- **原理**：触发 BFC（块级格式化上下文），使父容器包含浮动元素。
- **注意**：可能影响子元素的溢出内容显示。

### 2. 在父元素末尾添加空块级元素

- **实现**：在浮动元素后插入一个空的 `<div>`，并设置 `clear: both`。
- **缺点**：
  - 增加无意义的 HTML 标签，增加维护成本。
  - 违反结构与样式分离的原则。
- **评价**：早期常用，但现已不推荐。

### 3. 给父元素添加伪元素（推荐） 

通过给父元素添加一个伪元素（`::after`）并应用 `clear: both` 来清除浮动。   

- 优点 ：  
  - 不改变 HTML 结构，保持代码简洁。
  - 扩展性强，适用于大多数场景。

- 纯 CSS 样式解决，结构与样式分离（推荐）

```css
.clearfix::after {
    content: "";         /* 伪元素必须有内容，即使为空 */
    display: block;      /* 转为块级元素以生效清除 */
    clear: both;         /* 清除两侧浮动 */
    height: 0;           /* 避免占用空间 */
    visibility: hidden;  /* 隐藏伪元素 */
}

.clearfix {
    *zoom: 1;            /* IE6/7 兼容，触发 hasLayout */
}
```

这段代码主要用于解决浮动元素导致的父元素高度塌陷问题。通过给父元素添加一个 `::after` 伪元素，并设置其为块级元素并清除浮动，可以确保父元素能够正确地包含所有子元素的高度。

此外，还包含了针对不同浏览器的兼容性处理：
- `visibility: hidden` 和 `height: 0` 是为了在不影响布局的情况下，确保伪元素的存在。
- `*zoom: 1` 是专门针对 IE6/7 的 hack，用于触发 hasLayout，以解决这些旧版浏览器中的布局问题。

**效果** ：这种方法不会在 DOM 中添加额外元素，保持了 HTML 的干净结构，且具有较好的扩展性。

### 总结

- **浮动的本质**：`float` 是 CSS 中一种脱离标准流的布局方式，最初为实现文本环绕图像而设计，后被广泛用于水平布局。
- **常见问题**：浮动导致父元素高度塌陷，需通过清除浮动解决。
- **现代趋势**：
  - 随着 `flexbox` 和 `grid` 的兴起，`float` 在复杂布局中的使用逐渐减少。
  - 但在特定场景（如图文混排），`float` 仍具独特价值。
- **建议**：根据项目需求选择合适的布局方案，优先考虑现代布局技术，但在简单环绕需求中可保留 `float`。
