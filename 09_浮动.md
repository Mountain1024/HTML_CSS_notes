# 浮动

## 认识浮动

- **`float`属性**：使元素脱离标准文档流，向左或右移动，允许文本或其他内联元素环绕其周围。
- **设计初衷**：实现图文混排（如图片与文字环绕），而非复杂布局。
- **历史背景**：早期因布局方案有限，曾被用于多列布局，但非其设计初衷。

### 浮动与绝对定位对比

| 特性           | `float`                                                      | `position: absolute`                                         |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **文档流影响** | 脱离文档流，但同级元素会环绕它；父元素高度不包含浮动元素     | 完全脱离，不占据原有位置                                     |
| **内容交互**   | 允许文本和内联元素环绕浮动元素                               | 独立于文档流，与其他元素绝对层叠，不参与内容环绕             |
| **定位参考系** | 基于包含块（父容器）侧边移动，位置受浮动方向（left/right）约束 | 基于最近的已定位（position≠static）祖先元素，若无则参考初始包含块（浏览器视口） |
| **尺寸与布局** | 强制转换为块级元素，尺寸由内容决定                           | 强制转换为块级元素，尺寸可由定位属性（top/bottom等）直接控制 |
| **父元素影响** | 父容器需显式设置高度或清除浮动才能包含浮动元素               | 父容器若未设置定位，绝对定位元素将参考初始包含块；若父级已定位，则参考父级 |

> **提示**：浮动适合内容环绕场景，绝对定位适合独立元素的精准定位。

**常用取值**：

- `none`：不浮动（默认值）。
- `left`：向左浮动。
- `right`：向右浮动。

## 浮动规则

### 规则一：脱离标准流

 元素一旦浮动后，将脱离标准流。 

- 它会朝着左或右方向移动，直到其边界紧贴包含块（通常是父元素）或其他浮动元素的边界。
- **层叠顺序**：
  - 浮动元素位于非定位元素之上，但低于定位元素
  - 后声明的浮动元素覆盖前者，若空间不足则换行。

![image-20231224173533028](./assets/image-20231224173533028.png)

### 规则二：边界限制

- **包含块约束**：
  - 左浮动元素左边界不能超出父容器左边界。
  - 右浮动元素右边界不能超出父容器右边界。
- **负外边距的特殊处理**：
  - 设置负外边距（如`margin-left: -20px`）可让元素向外偏移，但超出父容器的部分：
    - 若父容器`overflow: visible`，超出内容可见；
    - 若父容器`overflow: hidden/auto`，超出内容被截断。

![image-20231224173607992](./assets/image-20231224173607992.png)

### 规则三：浮动元素的排列

浮动元素按顺序排列，不能 重叠：
- 左浮动元素紧贴前一个左浮动元素，右浮动元素紧贴前一个右浮动元素。
- 若水平空间不足，后续浮动元素会自动换行，寻找足够的空间。

![image-20231224173647618](./assets/image-20231224173647618.png)

### 规则四：与行内元素的交互

浮动元素不能与行内级内容层叠，行内级内容将会被浮动元素推出

- **行内内容**：被推出并环绕浮动元素，不与其重叠。
- **块级元素**：保持标准流位置，但其内部文本会被浮动元素推开。
- 若块级元素生成新的BFC（如设置 `overflow: hidden`），则不会与浮动元素重叠，而是并排排列。
- **示例**：左浮动的图片会使右侧文字环绕，形成经典的图文混排效果。

![image-20231224173758109](./assets/image-20231224173758109.png)

### 规则五：浮动后的对齐方式

浮动元素顶部与**当前行的顶部**对齐：

- 行内元素浮动后转为块级特性，顶部与所在行对齐。
- 块级元素浮动后，顶部默认贴近父容器顶部（除非受其他浮动元素影响）。

![image-20231224173900259](./assets/image-20231224173900259.png)

## 浮动问题：高度塌陷（Height Collapse）

- **原因** ：浮动元素脱离标准流，父元素无法感知其高度，导致高度塌陷（变为 0 或仅包含非浮动内容高度）。

- **示例**：

```html
<div class="parent">
  <img src="..." style="float: left;">
  <p>文本内容</p>
</div>
```

- 若父容器未清除浮动，其高度将仅包裹文本，图片可能溢出。

- 解决父元素高度坍塌问题的过程, 一般叫做清浮动(清理浮动、清除浮动)
- 清浮动的目的是
  - 让父元素计算总高度的时候, 把浮动子元素的高度算进去

## clear 属性

 `clear` 属性用于指定一个元素是否必须移动（清除浮动后）到在它之前的浮动元素下面。

`clear` 的常用取值： 

- `left`：元素顶部低于所有左浮动元素的底部。
- `right`：元素顶部低于所有右浮动元素的底部。
- `both`：元素顶部低于所有浮动元素的底部（最常用）。
- `none`：默认值，无清除行为。

## 清除浮动的方法

浮动元素脱离标准流后，父容器无法感知其高度，导致高度塌陷。清除浮动的核心是**强制父容器包含浮动子元素的高度**，通常通过触发 **BFC（块级格式化上下文）** 或直接清除浮动元素的影响。

### 1. 父容器设置 `overflow: hidden`

```css
.parent {
  overflow: hidden; /* 或 auto/scroll */
}
```

- **原理**：触发 BFC（块级格式化上下文），强制父容器包裹浮动子元素。
- **注意**：可能裁剪子元素的溢出内容（如超出边界的下拉菜单）。

### 2. 在父元素末尾添加空块级元素（旧方案）

- **实现**：在浮动元素后插入一个空的 `<div>`，并设置 `clear: both`。
- **缺点**：
  - 增加无意义的 HTML 标签，增加维护成本。
  - 违反结构与样式分离的原则。
- **评价**：早期常用，但现已不推荐。

### 3. 伪元素 `::after` 清除法（经典方案） 

通过给父元素添加一个伪元素（`::after`）并应用 `clear: both` 来清除浮动。

-  **实现**：通过伪元素 `::after` 生成一个隐藏的 BFC，清除浮动。

- 优点 ：  
  - 不改变 HTML 结构，保持代码简洁。
  - 扩展性强，适用于大多数场景。
  - 纯 CSS 样式解决，结构与样式分离（推荐）
  

```css
.clearfix::after {
  content: "";
  display: block;    /* 触发 BFC */
  clear: both;       /* 清除浮动 */
}

/* IE6/7 兼容 hack */
.clearfix {
  *zoom: 1;          /* 触发 hasLayout */
}
```

- `display: table` 触发 BFC，`clear: both` 确保父容器包裹浮动元素。
- `*zoom: 1` 是 IE6/7 的私有属性，通过 `hasLayout` 触发 BFC。

### **4. `display: flow-root`（首选）**

```css
.parent {
  display: flow-root; /* 触发 BFC 且无副作用 */
}
```

- **原理**：
  - `flow-root` 强制父容器生成 BFC，同时作为匿名块容器包含浮动子元素。
- **优点**：
  - **无副作用**：不裁剪内容，避免 `overflow` 的潜在问题。
  - **语义明确**：专为浮动布局设计，与 HTML5 `<flow-root>` 元素行为一致。
  - **性能高效**：无需伪元素或额外标签，渲染更轻量。

## 浮动元素特性变化

- **转为块级元素**：浮动后的元素自动获得`display: block`特性（即使原为行内元素）
- **宽度自适应**：未设置宽度时，浮动元素宽度由内容撑开（类似`inline-block`）

## 将多个行内级元素中间的空格（间隙）去除的方法

**方法 1：使用 Flex 布局**

将父元素设为 `display: flex`，自动忽略子元素间隙。

**方法 2：使用 Float 浮动**

通过浮动元素脱离文档流，但是需要处理父元素高度塌陷问题。
