# 浮动

## 认识浮动

`float` 属性用于将元素放置在容器的左侧或右侧，并允许文本及内联元素环绕其周围。

- **起源**：`float` 最初设计用于实现图像在文本中的浮动效果，例如杂志排版中图片周围环绕文字的场景。
- **演变**：在 CSS 早期，因缺乏完善的水平布局方案，`float` 被广泛用于多列布局，尽管这超出了其原始设计意图。  

> **提示**：浮动与绝对定位类似，都会使元素脱离标准流，以实现更灵活的布局。

可以通过 float 属性让元素产生浮动效果, float 的常用取值:

- `none`: 不浮动，默认值。

- `left`: 向左浮动。
- `right`: 向右浮动。

## 浮动规则

### 规则一：元素脱离标准流

 元素一旦浮动后，将脱离标准流。 

- 它会朝着左或右方向移动，直到其边界紧贴包含块（通常是父元素）或其他浮动元素的边界。
- **层叠关系** ：定位元素（如 `position: relative/absolute`）会层叠在浮动元素之上。

![image-20231224173533028](./assets/image-20231224173533028.png)

### 规则二：浮动元素的边界限制

浮动元素的位置受限于包含块边界：

- 向左浮动时，其左边界不得超出包含块的左边界；向右浮动时，其右边界不得超出包含块的右边界。
- **细节**：即使设置了负外边距（`margin`），浮动元素仍无法突破包含块的边界约束。

![image-20231224173607992](./assets/image-20231224173607992.png)

### 规则三：浮动元素的排列

浮动元素之间不能层叠，它们会依次排列。

- 如果一个元素浮动，而另一个浮动元素已经占据了该位置，后浮动的元素将紧贴前一个浮动元素（左浮找左浮，右浮找右浮）。
- 如果水平方向剩余的空间不足以显示浮动元素，后浮动元素将向下移动，直到有足够的空间为止。

![image-20231224173647618](./assets/image-20231224173647618.png)

### 规则四：浮动元素与行内元素的交互

浮动元素不会与行内级内容重叠，而是将其推出：

- 受影响的内容包括行内元素（`inline`）、`inline-block` 元素以及块级元素的文本内容。
- **示例**：一个左浮动的图片会将右侧的段落文字推开，形成环绕效果。

![image-20231224173758109](./assets/image-20231224173758109.png)

### 规则五：行内元素浮动后的对齐方式

- 行内元素或 `inline-block` 元素浮动后，其顶部会与所在行的顶部对齐：
  - **行为变化**：浮动会将这些元素转为块级特性，但仍保持与行基线的对齐关系。
  - **实例**：一个浮动的 `<span>` 标签，其顶部将对齐其原始所在行的顶部。

![image-20231224173900259](./assets/image-20231224173900259.png)

## 浮动问题：高度塌陷

- 由于浮动元素脱离了标准流, 变成了脱标元素, 所以不再向父元素汇报高度
  - 父元素计算总高度时, 就不会计算浮动子元素的高度, 导致了高度坍塌的问题
- **示例**：一个包含浮动 `<img>` 的 `<div>`，若无处理，其高度可能无法包裹图片。
- 解决父元素高度坍塌问题的过程, 一般叫做清浮动(清理浮动、清除浮动)
- 清浮动的目的是
  - 让父元素计算总高度的时候, 把浮动子元素的高度算进去

## clear 属性

 `clear` 属性用于指定一个元素是否必须移动（清除浮动后）到在它之前的浮动元素下面。

`clear` 的常用取值： 

- `left`：元素顶部低于所有左浮动元素的底部。
- `right`：元素顶部低于所有右浮动元素的底部。
- `both`：元素顶部低于所有浮动元素的底部（最常用）。
- `none`：默认值，无清除行为。

## 清楚浮动的方法

### 1. 给父元素设置固定高度 

- **实现**：直接指定 `height` 值。
- **缺点**：扩展性差，不适应动态内容。
- **评价**：简单但不推荐。

### 2. 在父元素末尾添加空块级元素

- **实现**：在浮动元素后插入一个空的 `<div>`，并设置 `clear: both`。
- **缺点**：
  - 增加无意义的 HTML 标签，增加维护成本。
  - 违反结构与样式分离的原则。
- **评价**：早期常用，但现已不推荐。

### 3. 给父元素添加伪元素（推荐） 

通过给父元素添加一个伪元素（`::after`）并应用 `clear: both` 来清除浮动。   

- 优点 ：  
  - 不改变 HTML 结构，保持代码简洁。
  - 扩展性强，适用于大多数场景。

- 纯 CSS 样式解决，结构与样式分离（推荐）

```css
.clearfix::after {
    content: "";         /* 伪元素必须有内容，即使为空 */
    display: block;      /* 转为块级元素以生效清除 */
    clear: both;         /* 清除两侧浮动 */
    height: 0;           /* 避免占用空间 */
    visibility: hidden;  /* 隐藏伪元素 */
}

.clearfix {
    *zoom: 1;            /* IE6/7 兼容，触发 hasLayout */
}
```

这段代码主要用于解决浮动元素导致的父元素高度塌陷问题。通过给父元素添加一个 `::after` 伪元素，并设置其为块级元素并清除浮动，可以确保父元素能够正确地包含所有子元素的高度。

此外，还包含了针对不同浏览器的兼容性处理：
- `visibility: hidden` 和 `height: 0` 是为了在不影响布局的情况下，确保伪元素的存在。
- `*zoom: 1` 是专门针对 IE6/7 的 hack，用于触发 hasLayout，以解决这些旧版浏览器中的布局问题。

**效果** ：这种方法不会在 DOM 中添加额外元素，保持了 HTML 的干净结构，且具有较好的扩展性。

## 布局方案对比

| 布局方式                   | 特点                           | 应用场景                 |
| -------------------------- | ------------------------------ | ------------------------ |
| **标准流** (`normal flow`) | 元素按顺序垂直堆叠             | 简单页面、线性内容布局   |
| **绝对定位** (`absolute`)  | 脱离标准流，自由定位，可层叠   | 弹窗、覆盖效果、复杂叠放 |
| **浮动** (`float`)         | 脱离标准流，水平排列，文本环绕 | 多列布局、图文混排       |

### 总结

- **浮动的本质**：`float` 是 CSS 中一种脱离标准流的布局方式，最初为实现文本环绕图像而设计，后被广泛用于水平布局。
- **常见问题**：浮动导致父元素高度塌陷，需通过清除浮动解决。
- **现代趋势**：
  - 随着 `flexbox` 和 `grid` 的兴起，`float` 在复杂布局中的使用逐渐减少。
  - 但在特定场景（如图文混排），`float` 仍具独特价值。
- **建议**：根据项目需求选择合适的布局方案，优先考虑现代布局技术，但在简单环绕需求中可保留 `float`。
